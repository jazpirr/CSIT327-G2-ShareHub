{# templates/admin/manage_users.html #}
{% extends "admin/admin_base.html" %}
{% load static %}
{% block title %}Manage Users · Admin{% endblock %}

{% block content %}
<div class="manage-users-container">
  <!-- Page Header -->
  <div class="users-header">
    <div class="header-content">
      <h1 class="page-title">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" class="title-icon">
          <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Manage Users
      </h1>
      <p class="page-subtitle">Control user permissions and access levels</p>
    </div>
    <div class="header-actions">
      <div class="search-box">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
          <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <input type="text" placeholder="Search users..." class="search-input">
      </div>
    </div>
  </div>

  <!-- Messages Container -->
  <div id="user-messages" aria-live="polite" class="messages-container"></div>

  <!-- Statistics Cards -->
  <div class="users-stats-grid">
    <div class="stat-card total-users-stat">
      <div class="stat-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="total-users-count">0</div>
        <div class="stat-label">Total Users</div>
        <div class="stat-trend">All registered users</div>
      </div>
    </div>

    <div class="stat-card admin-stat">
      <div class="stat-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M12 2l7 3v5c0 5-3.58 9.74-7 11-3.42-1.26-7-6-7-11V5l7-3z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value admin-count" id="admin-users-count">0</div>
        <div class="stat-label">Administrators</div>
        <div class="stat-trend">System administrators</div>
      </div>
    </div>

    <div class="stat-card blocked-stat">
      <div class="stat-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value blocked-count" id="blocked-users-count">0</div>
        <div class="stat-label">Blocked Users</div>
        <div class="stat-trend">Restricted access</div>
      </div>
    </div>

    <div class="stat-card active-stat">
      <div class="stat-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="active-users-count">0</div>
        <div class="stat-label">Active Users</div>
        <div class="stat-trend">Currently active</div>
      </div>
    </div>
  </div>

  <!-- Users Table Section -->
  <div class="users-table-section">
    <div class="table-header">
      <div class="table-title">
        <h3>User Management</h3>
        <div class="table-filters">
          <div class="filter-group">
            <label>Role:</label>
            <select class="filter-select" id="role-filter">
              <option value="all">All Roles</option>
              <option value="admin">Administrators</option>
              <option value="user">Regular Users</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Status:</label>
            <select class="filter-select" id="status-filter">
              <option value="all">All Status</option>
              <option value="active">Active</option>
              <option value="blocked">Blocked</option>
            </select>
          </div>
        </div>
      </div>
      <p>Manage user permissions and account status</p>
    </div>

    <div class="table-wrapper">
      {% if users %}
      <div class="users-grid">
        {% for u in users %}
        <div class="user-card" data-user-id="{{ u.id }}">
          <div class="user-header">
            <div class="user-avatar-large">
              {% if u.profile_picture %}
                <img src="{{ u.profile_picture }}" alt="{{ u.display_name }}" loading="lazy">
              {% else %}
                {{ u.display_name|default:u.email|slice:":1"|upper }}
              {% endif %}
            </div>
            <div class="user-badges">
              {% if u.is_admin %}
              <span class="badge admin-badge">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                  <path d="M12 2l7 3v5c0 5-3.58 9.74-7 11-3.42-1.26-7-6-7-11V5l7-3z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                </svg>
                Admin
              </span>
              {% endif %}
              {% if u.is_block %}
              <span class="badge blocked-badge">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                  <path d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Blocked
              </span>
              {% else %}
              <span class="badge active-badge">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                  <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Active
              </span>
              {% endif %}
            </div>
          </div>

          <div class="user-info">
            <h4 class="user-name">{{ u.display_name|default:u.email|escape }}</h4>
            <p class="user-email">{{ u.email|default:"No email"|escape }}</p>
            <div class="user-stats">
              <div class="stat">
                <span class="stat-number">0</span>
                <span class="stat-label">Items</span>
              </div>
              <div class="stat">
                <span class="stat-number">0</span>
                <span class="stat-label">Borrowed</span>
              </div>
            </div>
          </div>

          <div class="user-actions">
            <button class="action-btn admin-toggle-btn {% if u.is_admin %}demote{% else %}promote{% endif %}" 
                    data-user-id="{{ u.id }}" 
                    title="{% if u.is_admin %}Demote from admin{% else %}Promote to admin{% endif %}">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M12 2l7 3v5c0 5-3.58 9.74-7 11-3.42-1.26-7-6-7-11V5l7-3z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
              </svg>
              {{ u.is_admin|yesno:"Demote,Promote" }}
            </button>

            <button class="action-btn block-toggle-btn {% if u.is_block %}unblock{% else %}block{% endif %}" 
                    data-user-id="{{ u.id }}" 
                    title="{% if u.is_block %}Unblock user{% else %}Block user{% endif %}">
              {% if u.is_block %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Unblock
              {% else %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Block
              {% endif %}
            </button>

            <button class="action-btn details-btn" data-user-id="{{ u.id }}" title="View user details">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M12 12a3 3 0 100-6 3 3 0 000 6zM12 14c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Details
            </button>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="empty-state">
        <div class="empty-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
            <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3>No Users Found</h3>
        <p>There are no users to display. Users will appear here once they register.</p>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- User Details Modal -->
<div id="user-details-modal" class="modal hidden" role="dialog" aria-hidden="true">
  <div class="modal-backdrop"></div>
  <div class="modal-panel" role="document" aria-labelledby="user-details-title">
    <header class="modal-header">
      <h3 id="user-details-title">User Details</h3>
      <button id="close-user-details" class="modal-close" aria-label="Close">&times;</button>
    </header>

    <div class="modal-body">
      <div class="user-summary-row">
        <div class="user-profile">
          <div class="user-avatar-large" id="ud-avatar">
            <!-- avatar/image will be injected -->
          </div>
          <div class="user-profile-info">
            <div id="ud-name" class="profile-name"></div>
            <div id="ud-email" class="profile-email"></div>
            <div class="profile-stats">
              <span id="ud-total-owned" class="stat-item">Owned: 0</span>
              <span id="ud-total-borrowed" class="stat-item">Borrowed: 0</span>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-sections">
        <section class="modal-section">
          <h4>Items Owned</h4>
          <div id="ud-items-owned" class="items-grid">Loading…</div>
        </section>

        <section class="modal-section">
          <h4>Items Borrowed / Requests</h4>
          <div id="ud-items-borrowed" class="items-grid">Loading…</div>
        </section>
      </div>
    </div>

    <footer class="modal-footer">
      <button id="close-user-details-2" class="btn btn-secondary">Close</button>
    </footer>
  </div>
</div>
{% endblock %}

{% block scripts %}
{# safe JSON for JS to consume #}
{{ users_json|json_script:"users-data" }}

<script>
  // set globals *before* external script loads
  window.CSRF_TOKEN = "{{ csrf_token }}";
  window.TOGGLE_ADMIN_URL = "{% url 'toggle_user_admin' %}";
  window.TOGGLE_BLOCK_URL = "{% url 'toggle_user_block' %}";
  window.ADMIN_USER_DETAILS_URL = "{% url 'admin_user_details_api' %}";
</script>

<script defer src="{% static 'js/manage_users.js' %}"></script>

<style>
/* Manage Users Specific Styles */
.manage-users-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 20px;
}

.users-header {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  margin-bottom: 32px;
  padding-bottom: 24px;
  border-bottom: 1px solid var(--color-border-light);
}

.header-content {
  flex: 1;
}

.page-title {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: var(--font-size-3xl);
  font-weight: 700;
  color: var(--color-text-primary);
  margin-bottom: 8px;
}

.title-icon {
  color: var(--color-primary);
}

.page-subtitle {
  font-size: var(--font-size-lg);
  color: var(--color-text-secondary);
  margin: 0;
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 20px;
}

.search-box {
  display: flex;
  align-items: center;
  gap: 12px;
  background: var(--color-surface);
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid var(--color-border);
  box-shadow: var(--shadow-sm);
  min-width: 300px;
}

.search-box svg {
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

.search-input {
  border: none;
  background: none;
  outline: none;
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
  width: 100%;
}

.search-input::placeholder {
  color: var(--color-text-tertiary);
}

/* Statistics Grid */
.users-stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  margin-bottom: 32px;
}

.stat-card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 16px;
  padding: 24px;
  display: flex;
  align-items: center;
  gap: 16px;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-sm);
  position: relative;
  overflow: hidden;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark));
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.stat-card:hover::before {
  transform: scaleX(1);
}

.stat-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
}

.total-users-stat::before {
  background: linear-gradient(90deg, var(--color-primary), var(--color-primary-dark));
}

.admin-stat::before {
  background: linear-gradient(90deg, var(--color-success), #229653);
}

.blocked-stat::before {
  background: linear-gradient(90deg, var(--color-error), #e63c40);
}

.active-stat::before {
  background: linear-gradient(90deg, var(--color-info), #1e6fa8);
}

.stat-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.total-users-stat .stat-icon {
  background: var(--color-primary-light);
  color: var(--color-primary);
}

.admin-stat .stat-icon {
  background: var(--color-success-light);
  color: var(--color-success);
}

.blocked-stat .stat-icon {
  background: var(--color-error-light);
  color: var(--color-error);
}

.active-stat .stat-icon {
  background: var(--color-info-light);
  color: var(--color-info);
}

.stat-content {
  flex: 1;
}

.stat-value {
  font-size: 28px;
  font-weight: 800;
  color: var(--color-text-primary);
  line-height: 1;
  margin-bottom: 4px;
}

.stat-label {
  font-size: 14px;
  color: var(--color-text-secondary);
  font-weight: 600;
  margin-bottom: 2px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-trend {
  font-size: 12px;
  color: var(--color-text-tertiary);
}

/* Users Table Section */
.users-table-section {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 20px;
  padding: 24px;
  box-shadow: var(--shadow-sm);
}

.table-header {
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--color-border-light);
}

.table-title {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  margin-bottom: 8px;
}

.table-title h3 {
  font-size: var(--font-size-xl);
  font-weight: 700;
  color: var(--color-text-primary);
  margin: 0;
}

.table-filters {
  display: flex;
  gap: 16px;
  align-items: center;
}

.filter-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.filter-group label {
  font-size: 13px;
  color: var(--color-text-secondary);
  font-weight: 600;
}

.filter-select {
  padding: 8px 12px;
  border: 1px solid var(--color-border);
  border-radius: 8px;
  background: var(--color-surface);
  color: var(--color-text-primary);
  font-size: 13px;
  cursor: pointer;
}

.table-header p {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin: 0;
}

/* Users Grid */
.users-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 20px;
}

.user-card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: 16px;
  padding: 20px;
  transition: all 0.3s ease;
  box-shadow: var(--shadow-sm);
  position: relative;
  overflow: hidden;
}

.user-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: var(--color-primary);
  transition: width 0.3s ease;
}

.user-card:hover::before {
  width: 6px;
}

.user-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.user-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
}

.user-avatar-large {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: var(--color-primary);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 18px;
  flex-shrink: 0;
  position: relative;
  overflow: hidden;
}

.user-avatar-large img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

.user-badges {
  display: flex;
  flex-direction: column;
  gap: 4px;
  align-items: flex-end;
}

.badge {
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 4px;
}

.admin-badge {
  background: var(--color-success-light);
  color: var(--color-success);
}

.blocked-badge {
  background: var(--color-error-light);
  color: var(--color-error);
}

.active-badge {
  background: var(--color-info-light);
  color: var(--color-info);
}

.user-info {
  margin-bottom: 20px;
}

.user-name {
  font-size: 18px;
  font-weight: 700;
  color: var(--color-text-primary);
  margin: 0 0 4px 0;
}

.user-email {
  font-size: 14px;
  color: var(--color-text-tertiary);
  margin: 0 0 16px 0;
}

.user-stats {
  display: flex;
  gap: 16px;
}

.stat {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.stat-number {
  font-size: 16px;
  font-weight: 700;
  color: var(--color-text-primary);
}

.stat-label {
  font-size: 11px;
  color: var(--color-text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.user-actions {
  display: flex;
  gap: 8px;
}

.action-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px 12px;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.action-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
}

.admin-toggle-btn.promote {
  background: var(--color-primary);
  color: white;
}

.admin-toggle-btn.promote:hover:not(:disabled) {
  background: var(--color-primary-dark);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(123, 30, 30, 0.3);
}

.admin-toggle-btn.demote {
  background: var(--color-warning);
  color: var(--color-text-primary);
}

.admin-toggle-btn.demote:hover:not(:disabled) {
  background: #e6b400;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(246, 199, 0, 0.3);
}

.block-toggle-btn.block {
  background: var(--color-error);
  color: white;
}

.block-toggle-btn.block:hover:not(:disabled) {
  background: #e63c40;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(255, 84, 89, 0.3);
}

.block-toggle-btn.unblock {
  background: var(--color-success);
  color: white;
}

.block-toggle-btn.unblock:hover:not(:disabled) {
  background: #229653;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
}

.details-btn {
  background: var(--color-info);
  color: white;
}

.details-btn:hover:not(:disabled) {
  background: #1e6fa8;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(47, 58, 70, 0.3);
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 60px 20px;
}

.empty-icon {
  margin-bottom: 20px;
  opacity: 0.5;
}

.empty-icon svg {
  color: var(--color-text-tertiary);
}

.empty-state h3 {
  font-size: 20px;
  font-weight: 700;
  color: var(--color-text-primary);
  margin: 0 0 8px 0;
}

.empty-state p {
  font-size: 15px;
  color: var(--color-text-secondary);
  margin: 0;
  max-width: 400px;
  margin: 0 auto;
}

/* Enhanced Modal Styles */
.modal.hidden { display: none; }
.modal { 
  position: fixed; 
  inset: 0; 
  z-index: 1200; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
}

.modal-backdrop { 
  position: absolute; 
  inset: 0; 
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
}

.modal-panel { 
  position: relative; 
  background: var(--color-surface); 
  border-radius: 20px; 
  width: min(900px, 90%); 
  max-height: 85vh; 
  overflow: auto; 
  padding: 24px; 
  z-index: 2; 
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--color-border);
}

.modal-header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--color-border-light);
}

.modal-header h3 {
  font-size: 20px;
  font-weight: 700;
  color: var(--color-text-primary);
  margin: 0;
}

.modal-close { 
  background: none; 
  border: none; 
  font-size: 24px; 
  cursor: pointer; 
  color: var(--color-text-tertiary);
  padding: 4px;
  border-radius: 6px;
}

.modal-close:hover {
  background: var(--color-background);
  color: var(--color-text-primary);
}

.user-summary-row {
  margin-bottom: 24px;
}

.user-profile {
  display: flex;
  align-items: center;
  gap: 16px;
}

.user-profile-info {
  flex: 1;
}

.profile-name {
  font-size: 18px;
  font-weight: 700;
  color: var(--color-text-primary);
  margin-bottom: 4px;
}

.profile-email {
  font-size: 14px;
  color: var(--color-text-secondary);
  margin-bottom: 8px;
}

.profile-stats {
  display: flex;
  gap: 16px;
}

.stat-item {
  font-size: 13px;
  color: var(--color-text-secondary);
  font-weight: 600;
}

.modal-sections {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.modal-section h4 {
  font-size: 16px;
  font-weight: 600;
  color: var(--color-text-primary);
  margin: 0 0 12px 0;
}

.items-grid { 
  display: grid; 
  gap: 12px; 
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); 
}

.item-card { 
  border-radius: 12px; 
  border: 1px solid var(--color-border); 
  padding: 12px; 
  display: flex; 
  gap: 12px; 
  align-items: flex-start; 
  background: var(--color-surface);
  transition: all 0.2s ease;
}

.item-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-sm);
}

.item-thumb { 
  width: 60px; 
  height: 60px; 
  border-radius: 8px; 
  object-fit: cover; 
  flex-shrink: 0;
  background: var(--color-background);
}

.modal-footer {
  margin-top: 24px;
  text-align: right;
  padding-top: 16px;
  border-top: 1px solid var(--color-border-light);
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-secondary {
  background: var(--color-background);
  color: var(--color-text-primary);
  border: 1px solid var(--color-border);
}

.btn-secondary:hover {
  background: var(--color-border);
}

/* Messages Container */
.messages-container {
  position: fixed;
  top: 100px;
  right: 24px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-width: 400px;
}

.user-msg {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  border-radius: 12px;
  box-shadow: var(--shadow-lg);
  font-size: 14px;
  font-weight: 500;
  transition: all 0.3s ease;
  animation: slideInRight 0.3s ease-out;
  backdrop-filter: blur(8px);
  border-left: 4px solid;
}

@keyframes slideInRight {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.user-msg-info {
  background: rgba(39, 174, 96, 0.95);
  color: white;
  border-left-color: var(--color-success);
}

.user-msg-error {
  background: rgba(255, 84, 89, 0.95);
  color: white;
  border-left-color: var(--color-error);
}

/* Responsive Design */
@media (max-width: 768px) {
  .users-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 16px;
  }
  
  .search-box {
    min-width: 100%;
  }
  
  .users-stats-grid {
    grid-template-columns: 1fr;
  }
  
  .users-grid {
    grid-template-columns: 1fr;
  }
  
  .table-title {
    flex-direction: column;
    align-items: flex-start;
    gap: 16px;
  }
  
  .table-filters {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .user-actions {
    flex-direction: column;
  }
  
  .modal-panel {
    width: 95%;
    padding: 16px;
  }
  
  .user-profile {
    flex-direction: column;
    text-align: center;
  }
  
  .profile-stats {
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .manage-users-container {
    padding: 0 16px;
  }
  
  .stat-card {
    padding: 20px;
  }
  
  .user-stats {
    justify-content: space-around;
  }
  
  .items-grid {
    grid-template-columns: 1fr;
  }
}
</style>
{% endblock %}